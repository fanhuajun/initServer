#!/bin/bash
#operating system:  CentOS 6.x
# git clone https://github.com/357724264/initServer.git
software_path=/data/
install_path=/usr/local/

#yum install jdk-1.8
jdk() {
	#wget -P $software_path --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" http://download.oracle.com/otn-pub/java/jdk/8u111-b14/jdk-8u111-linux-x64.tar.gz
    [ -d  $install_path/java ] || mkdir -p $install_path/java
    cp $software_path/jdk-8*  $install_path/java/

    tar -zvxf  $install_path/java/jdk-* -C $install_path/java/
    cat ./data/javaEnvironment >> /etc/profile
    source /etc/profile
}

#yum install redis
install_redis() {
    yum install tcl
  
	# wget -P $software_path http://download.redis.io/releases/redis-3.2.8.tar.gz
	[ -d  $install_path/redis ] || mkdir -p $install_path/redis
	tar -zvxf  $software_path/redis-* -C $install_path/redis/
	cd $install_path/redis/redis-*/
	dir
	#make
    #make test
    make install

}
#wget install activemq
install_activemq() {
	wget -P $software_path http://mirrors.hust.edu.cn/apache//activemq/5.14.5/apache-activemq-5.14.5-bin.tar.gz
	[ -d $install_path/activemq ] || mkdir -p $install_path/activemq

	tar -zvxf $software_path/apache-activemq-*  -C $install_path/activemq/
}


#yum install nginx



#yum install mysql	CentOS 6.x
install_mysql() {
	cd -P $software_path

	wget https://repo.mysql.com//mysql57-community-release-el6-10.noarch.rpm
	sudo rpm -Uvh mysql57-community-release-el6-10.noarch.rpm

    ### start install
	#yum repolist all | grep mysql
	yum repolist enabled | grep mysql
	sudo yum install mysql-community-server
	sudo service mysqld start
	#sudo service mysqld status

	chkconfig mysqld on

	#mysql -uroot -p >B)kS+MVq5-#

}


#yum install mosquitto
mosquitto() {
	#配置yum
    cp ./data/mosquitto.repo  /etc/yum.repos.d/
	yum install mosquitto mosquitto-clients
	service mosquitto start
}
#wget download tomcat
tomcat() {
	wget -P $software_path https://mirrors.aliyun.com/apache/tomcat/tomcat-8/v8.5.14/bin/apache-tomcat-8.5.14.tar.gz

	[ -d  $install_path/tomcat ] || mkdir -p $install_path/tomcat
	tar -zvxf  $software_path/apache-tomcat-* -C $install_path/tomcat/
}


start(){
	#mosquitto;
	jdk;
	tomcat;
	install_redis;
}

testFun() {
	install_mysql;

}

case "$1" in
	start )
		start;;
	mosquitto)
        mosquitto;;
    test)
        testFun;;
		*)
        echo "Usage: $0 {start|mosquitto}"
            exit 1
esac
exit 0